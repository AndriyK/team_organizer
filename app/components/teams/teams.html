<div ng-controller="TeamsCtrl as teams">

    <h3 >My teams</h3>

    <h5 ng-hide="teams.hasTeams()">You have no related teams at the moment. Please create or find ones.</h5>

    <div ng-show="teams.hasTeams()">
        <uib-accordion close-others="true">
            <uib-accordion-group ng-repeat="team in teams.getTeams()">
                <uib-accordion-heading>
                    <i class="glyphicon glyphicon-cd" title="{{team.sport}}"></i>
                    {{team.name}}
                    <i class="pull-right glyphicon glyphicon-copyright-mark capitan_icon" ng-show="{{team.is_capitan}}" title="You are capitan of that team"></i>
                </uib-accordion-heading>
                <span class="col-md-4" ng-repeat="player in team.players">
                    {{player.name}}
                    <a ng-show="{{team.is_capitan}}" ng-click="teams.removePlayer(team.id, player.email)"><i class="glyphicon glyphicon-remove-sign" title="Remove player"></i></a>
                    <i class="glyphicon glyphicon-copyright-mark capitan_icon" ng-show="{{player.is_capitan}}" title="Capitan of the team"></i>
                </span>
                <hr>
                <div ng-show="{{team.is_capitan}}">
                    <div class="pull-right">
                        <button class="btn btn-default btn-sm" ng-click="teams.removeTeam(team.id)">Delete team</button>
                        <button class="btn btn-default btn-sm" ng-click="teams.renameTeam(team.id)">Rename team</button>
                    </div>
                    <div class="pull-left">
                        <form class="form-inline" ng-submit="teams.joinPlayer(team.id)">
                            <div class="form-group">
                                <input class="form-control input-sm" type="email" placeholder="New player's email" ng-model="teams.playerNew.mail">
                            </div>
                            <button type="submit" class="btn btn-default btn-sm">Join</button>
                        </form>
                    </div>
                </div>
                <div ng-hide="{{team.is_capitan}}">
                    <button class="btn btn-default btn-sm" ng-click="teams.leaveTeam(team.id)">Leave team</button>
                </div>
            </uib-accordion-group>
        </uib-accordion>
    </div>

    <div>
        <a class="btn btn-info btn-sm" ng-click="teams.showForm('new')">Add new team</a>
        <a class="btn btn-info btn-sm" ng-click="teams.showForm('search')">Find team</a>
    </div>

    <div class="well well-sm" style="margin-top:3px;" ng-show="teams.showNewTeamForm" ng-submit="teams.create()">
        <h4 class="text-center">New team</h4>
        <form class="form-inline">
            <div class="form-group">
                <label for="teamName">Name</label>
                <input type="text" id="teamName" class="form-control" placeholder="Team name" ng-model="teams.teamNew.name">
            </div>
            <div class="form-group">
                <label for="teamSport">Kind of sport</label>
                <select id="teamSport" class="form-control" ng-model="teams.teamNew.sport">
                    <option value="football">Football</option>
                    <option value="basketball">Basketball</option>
                    <option value="voleyball">Voleyball</option>
                </select>
            </div>
            <button type="submit" class="btn btn-default btn-sm">Add</button>
        </form>
    </div>

    <div class="well well-sm" style="margin-top:3px;" ng-show="teams.showSearchTeamForm" ng-submit="teams.findTeam()">
        <h4 class="text-center">Enter team name or team's player mail</h4>
        <form class="form-inline">
            <div class="form-group">
                <label for="searchName">Team name</label>
                <input type="text" class="form-control" id="searchName" ng-model="teams.teamSearch.name" value="">
            </div>
            <div class="form-group">
                <label for="searchmail">Player mail</label>
                <input type="email" class="form-control" id="searchMail" ng-model="teams.teamSearch.mail" value="">
            </div>
            <button type="submit" class="btn btn-default btn-sm">Find</button>
        </form>

        <div>
            <p class="text-danger">{{teams.teamSearch.error}}</p>
            <table class="table table-condensed" ng-show="teams.foundTeams">
                <thead>
                    <tr>
                        <th>Sport</th>
                        <th>Team name</th>
                        <th>Players</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="foundTeam in teams.foundTeams">
                        <td>{{foundTeam.sport}}</td>
                        <td>{{foundTeam.name}}</td>
                        <td>
                            <span class="label label-default" ng-repeat="player in foundTeam.players">{{player.name}}</span>
                        </td>
                        <td>
                            <button ng-click="teams.joinToTeam(foundTeam.id)">Join</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

</div>
